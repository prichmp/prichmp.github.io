<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Configuring Write Forward | Write Forward</title>

    <!-- Mobile tags -->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, width=device-width, height=device-height">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <!-- HTML Metadata -->
    <meta name="description" content="Configuring Write Forward">
    <meta name="keywords" content="Write Forward,WriteForward,java,logging,SLF4J,Logback,fluent,framework">

    <meta name='robots' content='index,follow'>
    <meta name='revisit-after' content='7 days'>
    <meta name='revised' content='2016-05-08 21:34:37 -0600'>

    <meta name='author' content='Matthew Prichard <green.matt@comcast.net>'>

    <!-- Permalink location of the page (full https://www.example.com format) -->
    <link rel="canonical" href="http://prichmp.github.io/Write-Forward/documentation/2016/05/03/configuration.html">

    <!-- Atom/RSS feeds -->
    <link rel="alternate" type="application/rss+xml" title="Write Forward" href="http://prichmp.github.io/Write-Forward/feed.xml">

    <!-- Schema.org micro data -->
    <meta itemprop="name" content="Configuring Write Forward">
    <meta name="description" content="Configuring Write Forward">
    <meta itemprop="image" content="images/icons/favicon-194x194.png">

    <!-- Facebook open graph -->
    <meta property="og:url" content="/Write-Forward">
    <meta property="og:title" content="Configuring Write Forward">
    <meta property="og:image" content="images/icons/favicon-194x194.png">
    <meta property="og:site_name" content="Configuring Write Forward">
    <meta property="og:description" content="Configuring Write Forward">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Configuring Write Forward">
    <meta name="twitter:description" content="Configuring Write Forward">
    <meta name="twitter:image" content="images/icons/favicon-194x194.png">

    <!-- Icons -->
    <!-- Apple iOS Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="images/icons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="images/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/icons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="images/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="images/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="images/icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="images/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="images/icons/apple-touch-icon-180x180.png">
    <!-- HTML Icons -->
    <link rel="shortcut icon" type="image/png" href="images/icons/favicon-32x32.png" sizes="32x32">
    <link rel="shortcut icon" type="image/png" href="images/icons/favicon-194x194.png" sizes="194x194">
    <link rel="shortcut icon" type="image/png" href="images/icons/favicon-96x96.png" sizes="96x96">
    <link rel="shortcut icon" type="image/png" href="images/icons/favicon-16x16.png" sizes="16x16">
    <!-- Android Icons and top bar color -->
    <link rel="manifest" href="images/icons/manifest.json">
    <meta name="theme-color" content="#ffffff">
    <!-- Windows Phone/Windows 10 Icons and metro tile color -->
    <meta name="msapplication-TileImage" content="images/icons/mstile-144x144.png">
    <meta name="msapplication-TileColor" content="#ed1c24">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="/Write-Forward/css/site.css">

    <!-- Syntax highlighter -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>

</head>


  <body style="background-image:url('/Write-Forward/images/blurry.jpg');">

    <div id="all">

    <header class="row-wrapper">

        <div class="row">

                <div class="column column-20">
                    <div class="logo"><a class="site-title" href="/Write-Forward/">Write Forward</a></div>
                </div><!-- .column -->

                <div id="nav-col" class="column column-80">
                    <nav>
                      <ul>
                        <li><a href="/Write-Forward/">Home</a></li>
                        <li><a href="/Write-Forward/documentation.html">Documentation</a></li>
                        <li><a href="/Write-Forward/download.html">Download</a></li>
                        <li><a href="//github.com/prichmp/Write-Forward">GitHub</a></li>
                      </ul>
                    </nav>
                </div><!-- .column -->

        </div><!-- .row -->

    </header>



                <main>

                <div class="row-wrapper">
                    <div class="row">

                        <div class="column column-20">
                            <ul class="toc">
                              
                                
                                <li><a class="page-link" href="/Write-Forward/documentation/2016/05/03/configuration.html">Configuring Write Forward</a></li>
                                
                              
                                
                                <li><a class="page-link" href="/Write-Forward/documentation/2016/05/02/slf4j.html">Using SLF4J</a></li>
                                
                              
                                
                                <li><a class="page-link" href="/Write-Forward/documentation/2016/05/02/mustashe.html">JMustache Formatter</a></li>
                                
                              
                                
                                <li><a class="page-link" href="/Write-Forward/documentation/2016/05/02/logback.html">Using Logback</a></li>
                                
                              
                                
                                <li><a class="page-link" href="/Write-Forward/documentation/2016/05/02/log4j.html">Using Log4j</a></li>
                                
                              
                                
                                <li><a class="page-link" href="/Write-Forward/documentation/2016/05/02/javautillogging.html">Using java.util.logging</a></li>
                                
                              
                                
                                <li><a class="page-link" href="/Write-Forward/documentation/2016/05/02/composing-messages.html">Composing messages</a></li>
                                
                              
                            </ul>
                        </div><!-- .column -->

                        <div class="column column-80">

                            <h1 id="configuring-write-forward">Configuring Write Forward</h1>

<p>There are three methods that apply configuration to Write Forward:
 - A YAML file
 - System Properties
 - Programmatic configuration</p>

<h2 id="system-properties">System Properties</h2>

<p>Currently Write Forward honors two system properties:</p>

<ul>
  <li><code class="highlighter-rouge">writeforward.configuration</code></li>
  <li>Sets the location of the configuration file. Write Forward will first attempt to load the file on the classpath using <code class="highlighter-rouge">.getResourceAsStream(configLocation)</code>, and if that fails Write Forward will load it as a file using <code class="highlighter-rouge">new File(configLocation)</code>.</li>
  <li>Type: String/Filepath</li>
  <li><code class="highlighter-rouge">writeforward.configuration.isslow</code></li>
  <li>Sets if Write Forward should perform the slow reflection operations: get stacktrace, find file/class/method/line the log was call from.</li>
  <li>Type: boolean (true/false)</li>
</ul>

<p>You can run your project with command line arguments. For example: <code class="highlighter-rouge">java -Dwriteforward.configuration="C:\Users\Me\MyProject\loggerconfig.yaml" -Dwriteforward.configuration.isslow="true" -jar myApplication.jar</code></p>

<h2 id="yaml-config-file">YAML Config File</h2>

<p>Write Forward Configuration Files are written in XML.</p>

<p>Write Forward checks the <code class="highlighter-rouge">writeforward.configuration</code> system property first for the location of the configuration file. If <code class="highlighter-rouge">writeforward.configuration</code> is not set or the configuration file is not where it is supposed to be, the Write Forward loads <code class="highlighter-rouge">write-forward-config.xml</code> by using the class loader. It is recommended to put this configuration file in <code class="highlighter-rouge">/src/main/resources</code> in your project.</p>

<p>The structure of a configuration file is as follows, noting what is requires and what is optional:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;writeforward</span> <span class="na">slow=</span><span class="s">"true"</span> <span class="na">stackframes=</span><span class="s">"50"</span><span class="nt">&gt;</span><span class="c">&lt;!-- REQUIRED: Root of the configuration. In theory other content could be in here as well.
slow: OPTIONAL: If true performs slow reflection operation
stackframes: OPTIONAL: The number of stack frames to add to the message. Default 50.
--&gt;</span>
	<span class="nt">&lt;outputs&gt;</span><span class="c">&lt;!-- REQUIRED sets what logging framework to log to. --&gt;</span>
		<span class="nt">&lt;output</span> <span class="na">name=</span><span class="s">"console"</span><span class="nt">&gt;</span><span class="c">&lt;!-- REQUIRED: Logging framework to use --&gt;</span>
			<span class="nt">&lt;format&gt;</span><span class="c">&lt;!-- REQUIRED: Formats the message --&gt;</span>

{{ timestamp }} [{{ thread }}] {{level}} {{#marker}}{{marker}} {{/marker}}{{#class}}{{ class }}.{{method}}:{{ line }}{{/class}}
	{{ message }}
	{{#values}}
	{{key}} = {{value}}
	{{/values}}
	{{#exception}}
	{{exception}}
	{{/exception}}
			<span class="nt">&lt;/format&gt;</span>
		<span class="nt">&lt;/output&gt;</span>
	<span class="nt">&lt;/outputs&gt;</span>
<span class="nt">&lt;/writeforward&gt;</span>
</code></pre>
</div>

<p>Outputs in the configuration file are a list. Each list entry outputs each log message to its own underlying frameworks.</p>

<p>Valid <code class="highlighter-rouge">name</code> for each <code class="highlighter-rouge">output</code> includes:
 - <code class="highlighter-rouge">slf4j</code>: Which writes out to slf4j
 - <code class="highlighter-rouge">log4j</code>: Which writes out to Log4j natively.
 - <code class="highlighter-rouge">javalogging</code>: Which writes out to java.util.logging
 - <code class="highlighter-rouge">console</code>: Which writes out to system.out</p>

<p>The <code class="highlighter-rouge">format</code> in each output only controls what message string is put in to the message field of each logger. Write Forward will attempt to input exceptions and markers, into the underlying framework nativly. For example, Write Forward will call <code class="highlighter-rouge">logger.error(message.getMarker().toSlf4jMarker(), message.getMessage(), message.getException());</code> in SLF4j.</p>

<h2 id="programmatic-configuration">Programmatic configuration</h2>

<p>Write Forward also has a programmatic API for setting the configuration.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import org.writeforward.logger.Configurator;

...

Configurator.build() //Starts a new programmatic configuration.
.withOutput(new StandardOutput(new DefaultMessageFormatter())) //Sets a Output to write to.
.commit(); // Commits the new configuration to be used.
</code></pre>
</div>

<p>See the JavaDocs for <code class="highlighter-rouge">org.writeforward.logger.MessageBuilder</code> for the full programatic API.</p>

<h2 id="what-if-a-configuration-is-not-found">What if a configuration is not found?</h2>

<p>In the event a configuration is not found by the first time the logger is called, Write Forward attempts to configure itself.</p>

<p>If a configuration file is not found on the classpath, Write forward will check to see what logging frameworks are on the classpath, and load the default configuration for that framework is. It checks to see if Logback or Log4j is on the classpath, and if one is, it loads the default Logback or Log4j configuration file.</p>

<h3 id="default-log4j-configuration">Default Log4j configuration:</h3>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;writeforward</span> <span class="na">slow=</span><span class="s">"true"</span> <span class="na">stackframes=</span><span class="s">"50"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;outputs&gt;</span>
		<span class="nt">&lt;output</span> <span class="na">name=</span><span class="s">"log4j"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;format&gt;</span>
{{ timestamp }} [{{ thread }}] {{ level }}{{#marker}}{{marker}}{{/marker}}{{#class}} {{ class }}.{{method}}:{{ line }}{{/class}} - {{ message }}
	{{#values}}
	{{key}} = {{value}}
	{{/values}}<span class="nt">&lt;/format&gt;</span>
		<span class="nt">&lt;/output&gt;</span>
	<span class="nt">&lt;/outputs&gt;</span>
<span class="nt">&lt;/writeforward&gt;</span>
</code></pre>
</div>

<h3 id="default-logback-configuration">Default Logback configuration</h3>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;writeforward</span> <span class="na">slow=</span><span class="s">"true"</span> <span class="na">stackframes=</span><span class="s">"50"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;outputs&gt;</span>
		<span class="nt">&lt;output</span> <span class="na">name=</span><span class="s">"console"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;format&gt;</span>
{{ timestamp }} [{{ thread }}] {{ level }}{{#marker}} {{marker}}{{/marker}}{{#class}} {{ class }}.{{method}}:{{ line }}{{/class}}
	{{ message }}
	{{#values}}
	{{key}} = {{value}}
	{{/values}}
	{{#exception}}
	{{exception}}
		{{#exception.stacktrace}}
		{{this}}
		{{/exception.stacktrace}}
	{{/exception}}<span class="nt">&lt;/format&gt;</span>
		<span class="nt">&lt;/output&gt;</span>
	<span class="nt">&lt;/outputs&gt;</span>
<span class="nt">&lt;/writeforward&gt;</span>
</code></pre>
</div>



                        </div><!-- .column -->

                    </div><!-- .row -->
                </div><!-- .row-wrapper -->

             </main>



    
            <footer class="row-wrapper">

                <div class="row">

                    <div class="column column-50">
                        Hosted by <a href="https://pages.github.com/">Github Pages</a>
                    </div><!-- .column -->

                    <div class="column column-50">
                        <a href="https://github.com/prichmp/Write-Forward">Fork this on Github!</a>
                    </div><!-- .column -->

                </div><!-- .row -->

            </footer>

        </div><!-- #all -->

        <!-- End of body Javascript  -->
        <!-- ======================================================================================= -->
        <!-- Syntax Highlighting init -->
        <script>
          hljs.initHighlightingOnLoad();
        </script>
        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-65868145-2', 'auto');
          ga('send', 'pageview');
        </script>


  </body>
</html>
